<?php
/**
 * Created by Malik Abiola.
 * Date: 18/02/2016
 * Time: 15:27
 * IDE: PhpStorm
 */

namespace MAbiola\Paystack\Tests;

use MAbiola\Paystack\Factories\PaystackHttpClientFactory;
use MAbiola\Paystack\Models\Plan;
use MAbiola\Paystack\Repositories\PlanResource;

class ModelAbstractionsTest extends BaseTestCase
{
    public function setUp()
    {
        parent::setUp(); // TODO: Change the autogenerated stub
    }

    public function testSetAttributesReturnsAttributes()
    {
        $plan = new Plan(new PlanResource(PaystackHttpClientFactory::make()));

        $plan->_setAttributes($this->planData);

        $this->assertArraySubset($this->planData, $plan->get(['name', 'description', 'amount', 'currency']));

        return $plan;
    }

    /**
     * @depends testSetAttributesReturnsAttributes
     * @param Plan $plan
     */
    public function testGetAttributes($plan)
    {
        $this->assertArraySubset($this->planData, $plan->get('name', 'description', 'amount', 'currency'));
    }

    public function testSetAttributesThrowsException()
    {
        $this->setExpectedException(\InvalidArgumentException::class);

        $plan = new Plan(new PlanResource(PaystackHttpClientFactory::make()));

        $plan->_setAttributes('');
    }

    public function tearDown()
    {
        parent::tearDown(); // TODO: Change the autogenerated stub
    }
}